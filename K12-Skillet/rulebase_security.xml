<rules>
   {%- if INCLUDE_COUNTRY_BLOCK == 'yes' %}
  <entry name="Inbound Country Block">
    <to>
      <member>any</member>
    </to>
    <from>
      <member>Untrust</member>
    </from>
    <source>
      <member>CA</member>
      <member>Cloud Platforms - Amazon</member>
      <member>Cloud Platforms - Google</member>
      <member>Cloud Platforms - Microsoft</member>
      <member>MX</member>
      <member>US</member>
    </source>
    <destination>
      <member>any</member>
    </destination>
    <source-user>
      <member>any</member>
    </source-user>
    <category>
      <member>any</member>
    </category>
    <application>
      <member>any</member>
    </application>
    <service>
      <member>any</member>
    </service>
    <hip-profiles>
      <member>any</member>
    </hip-profiles>
    <action>deny</action>
    <negate-source>yes</negate-source>
    <log-setting>default</log-setting>
    <tag>
      <member>Inbound</member>
      <member>Deny</member>
    </tag>
  </entry>
  <entry name="Outbound Country Block">
    <to>
      <member>Untrust</member>
    </to>
    <from>
      <member>any</member>
    </from>
    <source>
      <member>any</member>
    </source>
    <destination>
      <member>CA</member>
      <member>Cloud Platforms - Amazon</member>
      <member>Cloud Platforms - Google</member>
      <member>Cloud Platforms - Microsoft</member>
      <member>MX</member>
      <member>US</member>
    </destination>
    <source-user>
      <member>any</member>
    </source-user>
    <category>
      <member>any</member>
    </category>
    <application>
      <member>any</member>
    </application>
    <service>
      <member>any</member>
    </service>
    <hip-profiles>
      <member>any</member>
    </hip-profiles>
    <action>drop</action>
    <negate-destination>yes</negate-destination>
    <log-setting>default</log-setting>
    <tag>
      <member>Outbound</member>
      <member>Deny</member>
    </tag>
  </entry>
   {% endif %}
  <entry name="Block Quic">
    <to>
      <member>any</member>
    </to>
    <from>
      <member>any</member>
    </from>
    <source>
      <member>any</member>
    </source>
    <destination>
      <member>any</member>
    </destination>
    <source-user>
      <member>any</member>
    </source-user>
    <category>
      <member>any</member>
    </category>
    <application>
      <member>quic</member>
    </application>
    <service>
      <member>application-default</member>
    </service>
    <hip-profiles>
      <member>any</member>
    </hip-profiles>
    <action>deny</action>
    <log-end>no</log-end>
    <description>Block Quic to force Chrome to fallback to SSL</description>
    <tag>
      <member>Deny</member>
    </tag>
  </entry>
     {%- if SAFE_SEARCH == 'SSL_DECRYPTION' %}
  <entry name="Outbound DNS To Sanctioned Servers">
    <profile-setting>
      <group>
        <member>default</member>
      </group>
    </profile-setting>
    <to>
      <member>any</member>
    </to>
    <from>
      <member>Trust</member>
    </from>
    <source>
      <member>any</member>
    </source>
    <destination>
      <member>Sanctioned DNS Servers</member>
    </destination>
    <source-user>
      <member>any</member>
    </source-user>
    <category>
      <member>any</member>
    </category>
    <application>
      <member>dns</member>
    </application>
    <service>
      <member>application-default</member>
    </service>
    <hip-profiles>
      <member>any</member>
    </hip-profiles>
    <action>allow</action>
    <log-setting>default</log-setting>
    <tag>
      <member>Outbound</member>
    </tag>
  </entry>
  <entry name="Outbound DNS Block">
    <to>
      <member>any</member>
    </to>
    <from>
      <member>Trust</member>
    </from>
    <source>
      <member>any</member>
    </source>
    <destination>
      <member>any</member>
    </destination>
    <source-user>
      <member>any</member>
    </source-user>
    <category>
      <member>any</member>
    </category>
    <application>
      <member>dns</member>
    </application>
    <service>
      <member>application-default</member>
    </service>
    <hip-profiles>
      <member>any</member>
    </hip-profiles>
    <action>deny</action>
    <log-setting>default</log-setting>
    <tag>
      <member>Outbound</member>
      <member>Deny</member>
    </tag>
    <rule-type>interzone</rule-type>
  </entry>
  <entry name="Outbound Web Browsing Allowed Search Engines">
    <profile-setting>
      <group>
        <member>default</member>
      </group>
    </profile-setting>
    <to>
      <member>any</member>
    </to>
    <from>
      <member>any</member>
    </from>
    <source>
      <member>any</member>
    </source>
    <destination>
      <member>any</member>
    </destination>
    <source-user>
      <member>any</member>
    </source-user>
    <category>
      <member>any</member>
    </category>
    <application>
      <member>google-base</member>
      <member>ssl</member>
      <member>web-browsing</member>
    </application>
    <service>
      <member>application-default</member>
    </service>
    <hip-profiles>
      <member>any</member>
    </hip-profiles>
    <action>allow</action>
    <log-setting>default</log-setting>
    <tag>
      <member>Outbound</member>
    </tag>
  </entry>
     {% elif SAFE_SEARCH == "DNS_PROXY" %}
  <entry name="Outbound DNS To Sanctioned Servers">
    <profile-setting>
      <group>
        <member>default</member>
      </group>
    </profile-setting>
    <to>
      <member>any</member>
    </to>
    <from>
      <member>Trust</member>
    </from>
    <source>
      <member>any</member>
    </source>
    <destination>
      <member>Sanctioned DNS Servers</member>
    </destination>
    <source-user>
      <member>any</member>
    </source-user>
    <category>
      <member>any</member>
    </category>
    <application>
      <member>dns</member>
    </application>
    <service>
      <member>application-default</member>
    </service>
    <hip-profiles>
      <member>any</member>
    </hip-profiles>
    <action>allow</action>
    <log-setting>default</log-setting>
    <tag>
      <member>Outbound</member>
    </tag>
  </entry>
  <entry name="Outbound To FW DNS Proxy">
    <profile-setting>
      <group>
        <member>Outbound</member>
      </group>
    </profile-setting>
    <to>
      <member>Trust</member>
    </to>
    <from>
      <member>Trust</member>
    </from>
    <source>
      <member>any</member>
    </source>
    <destination>
      <member>FW - Trust</member>
    </destination>
    <source-user>
      <member>any</member>
    </source-user>
    <category>
      <member>any</member>
    </category>
    <application>
      <member>dns</member>
    </application>
    <service>
      <member>application-default</member>
    </service>
    <hip-profiles>
      <member>any</member>
    </hip-profiles>
    <tag>
      <member>Outbound</member>
    </tag>
    <action>allow</action>
    <log-setting>default</log-setting>
    <rule-type>intrazone</rule-type>
    <description>Allow DNS Proxy</description>
  </entry>
  <entry name="Outbound DNS Block">
    <to>
      <member>any</member>
    </to>
    <from>
      <member>Trust</member>
    </from>
    <source>
      <member>any</member>
    </source>
    <destination>
      <member>any</member>
    </destination>
    <source-user>
      <member>any</member>
    </source-user>
    <category>
      <member>any</member>
    </category>
    <application>
      <member>dns</member>
    </application>
    <service>
      <member>application-default</member>
    </service>
    <hip-profiles>
      <member>any</member>
    </hip-profiles>
    <action>deny</action>
    <log-setting>default</log-setting>
    <tag>
      <member>Outbound</member>
      <member>Deny</member>
    </tag>
    <rule-type>interzone</rule-type>
  </entry>
  <entry name="Outbound Web Browsing Allowed Search Engines">
    <profile-setting>
      <group>
        <member>default</member>
      </group>
    </profile-setting>
    <to>
      <member>any</member>
    </to>
    <from>
      <member>any</member>
    </from>
    <source>
      <member>any</member>
    </source>
    <destination>
      <member>any</member>
    </destination>
    <source-user>
      <member>any</member>
    </source-user>
    <category>
      <member>any</member>
    </category>
    <application>
      <member>google-base</member>
      <member>ssl</member>
      <member>web-browsing</member>
    </application>
    <service>
      <member>application-default</member>
    </service>
    <hip-profiles>
      <member>any</member>
    </hip-profiles>
    <action>allow</action>
    <log-setting>default</log-setting>
    <tag>
      <member>Outbound</member>
    </tag>
  </entry>
     {% elif SAFE_SEARCH == "LOCAL_DNS_CNAME" %}
  <entry name="Outbound DNS Internal Servers">
    <profile-setting>
      <group>
        <member>default</member>
      </group>
    </profile-setting>
    <to>
      <member>Untrust</member>
    </to>
    <from>
      <member>Trust</member>
    </from>
    <source>
      <member>Local DNS Servers</member>
    </source>
    <destination>
      <member>any</member>
    </destination>
    <source-user>
      <member>any</member>
    </source-user>
    <category>
      <member>any</member>
    </category>
    <application>
      <member>dns</member>
    </application>
    <service>
      <member>application-default</member>
    </service>
    <hip-profiles>
      <member>any</member>
    </hip-profiles>
    <action>allow</action>
    <log-setting>default</log-setting>
    <tag>
      <member>Outbound</member>
    </tag>
  </entry>
  <entry name="Inbound DNS Internal Servers">
    <profile-setting>
      <group>
        <member>default</member>
      </group>
    </profile-setting>
    <to>
      <member>Trust</member>
    </to>
    <from>
      <member>Untrust</member>
    </from>
    <source>
      <member>any</member>
    </source>
    <destination>
      <member>Local DNS Servers</member>
    </destination>
    <source-user>
      <member>any</member>
    </source-user>
    <category>
      <member>any</member>
    </category>
    <application>
      <member>dns</member>
    </application>
    <service>
      <member>application-default</member>
    </service>
    <hip-profiles>
      <member>any</member>
    </hip-profiles>
    <action>allow</action>
    <log-setting>default</log-setting>
    <tag>
      <member>Inbound</member>
    </tag>
  </entry>
  <entry name="Outbound DNS Block">
    <to>
      <member>any</member>
    </to>
    <from>
      <member>Trust</member>
    </from>
    <source>
      <member>any</member>
    </source>
    <destination>
      <member>any</member>
    </destination>
    <source-user>
      <member>any</member>
    </source-user>
    <category>
      <member>any</member>
    </category>
    <application>
      <member>dns</member>
    </application>
    <service>
      <member>application-default</member>
    </service>
    <hip-profiles>
      <member>any</member>
    </hip-profiles>
    <action>deny</action>
    <log-setting>default</log-setting>
    <tag>
      <member>Outbound</member>
      <member>Deny</member>
    </tag>
    <rule-type>interzone</rule-type>
  </entry>
  <entry name="Outbound Web Browsing Allowed Search Engines">
    <profile-setting>
      <group>
        <member>default</member>
      </group>
    </profile-setting>
    <to>
      <member>any</member>
    </to>
    <from>
      <member>any</member>
    </from>
    <source>
      <member>any</member>
    </source>
    <destination>
      <member>any</member>
    </destination>
    <source-user>
      <member>any</member>
    </source-user>
    <category>
      <member>any</member>
    </category>
    <application>
      <member>google-base</member>
      <member>ssl</member>
      <member>web-browsing</member>
    </application>
    <service>
      <member>application-default</member>
    </service>
    <hip-profiles>
      <member>any</member>
    </hip-profiles>
    <action>allow</action>
    <log-setting>default</log-setting>
    <tag>
      <member>Outbound</member>
    </tag>
  </entry>
    {% endif %}
    {%- if YOUTUBE_FILTER == "yes" %}
  <entry name="Outbound YouTube - District Approved List">
    <profile-setting>
      <group>
        <member>default</member>
      </group>
    </profile-setting>
    <to>
      <member>any</member>
    </to>
    <from>
      <member>Trust</member>
    </from>
    <source>
      <member>any</member>
    </source>
    <destination>
      <member>any</member>
    </destination>
    <source-user>
      <member>any</member>
    </source-user>
    <category>
      <member>YouTube - District Approved List</member>
    </category>
    <application>
      <member>youtube-base</member>
    </application>
    <service>
      <member>application-default</member>
    </service>
    <hip-profiles>
      <member>any</member>
    </hip-profiles>
    <action>allow</action>
    <log-setting>default</log-setting>
    <tag>
      <member>Outbound</member>
    </tag>
  </entry>
  <entry name="Outbound Block YouTube">
    <profile-setting>
      <profiles>
        <url-filtering>
          <member>BlockYouTube</member>
        </url-filtering>
      </profiles>
    </profile-setting>
    <to>
      <member>any</member>
    </to>
    <from>
      <member>any</member>
    </from>
    <source>
      <member>any</member>
    </source>
    <destination>
      <member>any</member>
    </destination>
    <source-user>
      <member>any</member>
    </source-user>
    <category>
      <member>YouTubeWatch</member>
    </category>
    <application>
      <member>youtube-base</member>
    </application>
    <service>
      <member>application-default</member>
    </service>
    <hip-profiles>
      <member>any</member>
    </hip-profiles>
    <action>allow</action>
    <log-setting>default</log-setting>
    <tag>
      <member>Outbound</member>
    </tag>
  </entry>
    {% endif %}
</rules>
